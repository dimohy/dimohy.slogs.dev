---
title: "ë©”ì„œë“œ í˜¸ì¶œì„ ì¸í„°ì…‰í„°ë¡œ ëŒ€ì²´í•˜ê¸°"
datePublished: Wed Aug 09 2023 00:08:06 GMT+0000 (Coordinated Universal Time)
cuid: cll2z1zi2000009l5dkex5oki
slug: exploring-the-dotnet-8-preview-changing-method-calls-with-interceptors
canonical: https://andrewlock.net/exploring-the-dotnet-8-preview-changing-method-calls-with-interceptors/
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1691536740662/2c5d6b53-5273-4402-83b2-85b73df46c23.jpeg
tags: net, dotnet

---

> Andrew Lockë‹˜ì˜ [Replacing method calls with Interceptors](https://andrewlock.net/exploring-the-dotnet-8-preview-changing-method-calls-with-interceptors/)ì„ DeepLì„ ë„ì›€ìœ¼ë¡œ ë²ˆì—­í•˜ì˜€ìŠµë‹ˆë‹¤.

ì´ ê¸€ì€ [.NET 8 ë¯¸ë¦¬ ë³´ê¸° ì‚´í´ë³´ê¸° ì‹œë¦¬ì¦ˆ](https://dimohy.hashnode.dev/series/exploring-dotnet8-preview)ì˜ ë‹¤ì„¯ ë²ˆì§¸ ê¸€ì…ë‹ˆë‹¤.

[1ë¶€ - ìƒˆë¡œìš´ êµ¬ì„± ë°”ì¸ë” ì†ŒìŠ¤ ìƒì„±ê¸° ì‚¬ìš©í•˜ê¸°](https://dimohy.hashnode.dev/7ioi66gc7jq0ioq1royessdrsjtsnbjrjzqg7iam7iqkioydneyeseq4scdsgqzsmqk)  
[2ë¶€ - ë¯¸ë‹ˆë©€ API AOT ì»´íŒŒì¼ í…œí”Œë¦¿](https://dimohy.hashnode.dev/the-minimal-api-aot-compilation-template)  
[3ë¶€ - WebApplication.CreateBuilder()ì™€ ìƒˆë¡œìš´ CreateSlimBuilder() ë©”ì„œë“œ ë¹„êµí•˜ê¸°](https://dimohy.hashnode.dev/webapplicationcreatebuilder-createslimbuilder)  
[4ë¶€ - ìƒˆë¡œìš´ ë¯¸ë‹ˆë©€ API ì†ŒìŠ¤ ìƒì„±ê¸° ì‚´í´ë³´ê¸°](https://dimohy.hashnode.dev/exploring-the-dotnet-8-preview-exploring-the-new-minimal-api-source-generator)  
5ë¶€ - ë©”ì„œë“œ í˜¸ì¶œì„ ì¸í„°ì…‰í„°ë¡œ ëŒ€ì²´í•˜ê¸°(ì´ ê²Œì‹œë¬¼)

ì´ ì‹œë¦¬ì¦ˆì—ì„œëŠ” .NET 8 í”„ë¦¬ë·°ì— í¬í•¨ëœ ëª‡ ê°€ì§€ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì‚´í´ë´…ë‹ˆë‹¤. ì´ ê¸€ì—ì„œëŠ” C#12 ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥ì¸ [ì¸í„°ì…‰í„°](https://devblogs.microsoft.com/dotnet/new-csharp-12-preview-features/#interceptors)ë¥¼ ì‚´í´ë³´ê³ , ì‘ë™ ë°©ì‹ê³¼ ìœ ìš©í•œ ì´ìœ ë¥¼ ì‚´í´ë³´ê³ , [ì´ì „ ê¸€](https://dimohy.slogs.dev/exploring-the-dotnet-8-preview-exploring-the-new-minimal-api-source-generator)ì—ì„œ ì†Œê°œí•œ ë¯¸ë‹ˆë©€ API ì†ŒìŠ¤ ìƒì„±ê¸°ê°€ ì–´ë–»ê²Œ ì—…ë°ì´íŠ¸ë˜ì—ˆëŠ”ì§€ ì„¤ëª…í•©ë‹ˆë‹¤.

> ì´ ê²Œì‹œë¬¼ì€ ëª¨ë‘ í”„ë¦¬ë·° ë¹Œë“œë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ 2023ë…„ 11ì›”ì— .NET 8ì´ ìµœì¢… ì¶œì‹œë˜ê¸° ì „ì— ì¼ë¶€ ê¸°ëŠ¥ì´ ë³€ê²½(ë˜ëŠ” ì œê±°)ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

## ì¸í„°ì…‰í„°ë€ ë¬´ì—‡ì´ë©° ì™œ í•„ìš”í•œê°€ìš”?

ì¸í„°ì…‰í„°ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë©”ì„œë“œ í˜¸ì¶œì„ ëŒ€ì²´ ë©”ì„œë“œë¡œ ëŒ€ì²´(ë˜ëŠ” "ì¸í„°ì…‰íŠ¸")í•  ìˆ˜ ìˆëŠ” C#12ì˜ í¥ë¯¸ë¡œìš´ ìƒˆ ì‹¤í—˜ì  ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì•±ì´ ì»´íŒŒì¼ë˜ë©´ ì»´íŒŒì¼ëŸ¬ê°€ ìë™ìœ¼ë¡œ ì›ë˜ ë©”ì„œë“œ í˜¸ì¶œì„ ëŒ€ì²´ ë©”ì„œë“œë¡œ "êµì²´"í•©ë‹ˆë‹¤.

ì—¬ê¸°ì„œ ë‹¹ì—°í•œ ì§ˆë¬¸ì€ ì™œ ê·¸ë ‡ê²Œ í•˜ë ¤ê³  í•˜ëŠëƒëŠ” ê²ƒì…ë‹ˆë‹¤. ëŒ€ì²´ ë©”ì„œë“œë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?

ì£¼ëœ ì´ìœ ëŠ” [ì´ ì‹œë¦¬ì¦ˆì—ì„œ ì—¬ëŸ¬ ì°¨ë¡€ ì„¤ëª…í•œ ë°” ìˆëŠ”](https://dimohy.hashnode.dev/the-minimal-api-aot-compilation-template) ë¯¸ë¦¬ ì»´íŒŒì¼(AOT) ë•Œë¬¸ì…ë‹ˆë‹¤(ì´ ê¸°ëŠ¥ì´ .NET 8ì˜ í•µì‹¬ ê¸°ëŠ¥ì´ë¼ëŠ” ì ì„ ê°ì•ˆí•˜ë©´ ë‹¹ì—°í•œ ì¼ì…ë‹ˆë‹¤). ì¸í„°ì…‰í„°ëŠ” íŠ¹ë³„íˆ AOTë¥¼ ìœ„í•œ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ë¶„ëª…íˆ AOTë¥¼ ì—¼ë‘ì— ë‘ê³  ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ì „ì—ëŠ” AOTì— ì í•©í•˜ì§€ ì•Šì•˜ë˜ ì½”ë“œë¥¼ ê°€ì ¸ì™€ì„œ ì†ŒìŠ¤ ìƒì„± ë²„ì „ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê³ ê°ì€ ì½”ë“œë¥¼ ë³€ê²½í•  í•„ìš”ê°€ ì—†ìœ¼ë©°, ì†ŒìŠ¤ ìƒì„±ê¸°ê°€ ë©”ì„œë“œ í˜¸ì¶œì„ ìë™ìœ¼ë¡œ "ì—…ê·¸ë ˆì´ë“œ"í•˜ì—¬ ì†ŒìŠ¤ ìƒì„± ë²„ì „ì„ ì‚¬ìš©í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. ìµìˆ™í•˜ê²Œ ë“¤ë¦°ë‹¤ë©´ [êµ¬ì„± ì†ŒìŠ¤ ìƒì„±ê¸°](https://andrewlock.net/exploring-the-dotnet-8-preview-using-the-new-configuration-binder-source-generator/)ì™€ [ê¸°ì¡´ì˜ ë¯¸ë‹ˆë©€ API ì†ŒìŠ¤ ìƒì„±ê¸°](https://andrewlock.net/exploring-the-dotnet-8-preview-exploring-the-new-minimal-api-source-generator/)ê°€ ì´ë¯¸ ê·¸ë ‡ê²Œ í•˜ê³  ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤! ì°¨ì´ì ì€ ì´ëŸ¬í•œ ìƒì„±ê¸°ëŠ” í˜„ì¬ ë©”ì„œë“œ íŠ¹ì´ì„± ê·œì¹™ì— ì˜ì¡´í•˜ì—¬ ì»´íŒŒì¼ëŸ¬ê°€ ì†ŒìŠ¤ ìƒì„±ëœ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë„ë¡ "ì†ì´ëŠ”" ê²ƒì…ë‹ˆë‹¤. ì¸í„°ì…‰í„°ëŠ” ëŒ€ì²´ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤.

ì´ë¡ ì ìœ¼ë¡œ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ë©´ êµ¬ì„± ì†ŒìŠ¤ ìƒì„±ê¸°ë‚˜ ë¯¸ë‹ˆë©€ API ì†ŒìŠ¤ ìƒì„±ê¸°ì™€ ê°™ì€ ì†ŒìŠ¤ ìƒì„±ê¸°ë¥¼ ë” ì‰½ê²Œ ë¹Œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹¬ì§€ì–´ [ì •ê·œì‹ ìƒì„±ê¸°](https://learn.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-source-generators)ë‚˜ [ë¡œê¹… ìƒì„±ê¸°](https://andrewlock.net/exploring-dotnet-6-part-8-improving-logging-performance-with-source-generators/)ì™€ ê°™ì€ ê¸°ì¡´ ì†ŒìŠ¤ ìƒì„±ê¸°ë¥¼ ê°œì„ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ìƒì„±ê¸°ê°€ ìš”êµ¬í•˜ëŠ” íŒ¨í„´ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì½”ë“œë¥¼ ë³€ê²½í•  í•„ìš” ì—†ì´ ìƒì„±ê¸°ê°€ ìë™ìœ¼ë¡œ ê¸°ì¡´ ì½”ë“œë¥¼ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ì ì–´ë„ ì´ë¡ ì ìœ¼ë¡œëŠ” ë§ì´ì£ .

> ëª‡ ë‹¬ ì „ì— [.NET ì»¤ë®¤ë‹ˆí‹° ìŠ¤íƒ ë“œì—…ì—ì„œ ì¸í„°ì…‰í„°ì— ëŒ€í•œ í›Œë¥­í•œ í† ë¡ ](https://www.youtube.com/watch?v=X1_QeH1yAto&list=PLdo4fOcmZ0oX-DBuRG4u58ZTAJgBAeQ-t&index=12)ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ê¼­ ì‹œì²­í•´ ë³´ì‹œê¸¸ ê°•ë ¥íˆ ì¶”ì²œí•©ë‹ˆë‹¤!

ì´ ëª¨ë“  ê²ƒì´ ë§¤ìš° ì¶”ìƒì ì´ë¯€ë¡œ ë‹¤ìŒ ì„¹ì…˜ì—ì„œëŠ” ì¸í„°ì…‰í„°ì˜ ì‘ë™ ì›ë¦¬ë¥¼ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ë§¤ìš° ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

## ê°„ë‹¨í•œ (ë¹„ì‹¤ìš©ì ì¸) ì‘ë™ ì¸í„°ì…‰í„° ì˜ˆì‹œ

ì´ ì„¹ì…˜ì—ì„œëŠ” ì¸í„°ì…‰í„°ì˜ ë§¤ìš° ë¹„ì‹¤ìš©ì ì¸ ì˜ˆë¥¼ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ì¸í„°ì…‰í„°ëŠ” ì†ŒìŠ¤ ìƒì„±ê¸°ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆì§€ë§Œ ë°˜ë“œì‹œ ê·¸ëŸ´ í•„ìš”ëŠ” ì—†ìœ¼ë¯€ë¡œ ê°„ë‹¨í•˜ê²Œ "ì›ì‹œ" ì¸í„°ì…‰í„°ë§Œ ì‘ì„±í•´ ë³´ê² ìŠµë‹ˆë‹¤!

ìš°ì„ , .NET 8 ë¯¸ë¦¬ë³´ê¸° 6 ì´ìƒì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì—¬ ìƒˆ ì•±ì„ ë§Œë“­ë‹ˆë‹¤([ìƒˆ AOT í…œí”Œë¦¿](https://andrewlock.net/exploring-the-dotnet-8-preview-the-minimal-api-aot-template/)ì¼ í•„ìš”ëŠ” ì—†ìŒ)

```bash
dotnet new web
```

ì´ë ‡ê²Œ í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì•±ì´ ìƒì„±ë©ë‹ˆë‹¤.

```csharp
var builder = WebApplication.CreateBuilder(args);
var app = builder.Build();

app.MapGet("/", () => "Hello World!");

app.Run();
```

ë‹¤ìŒìœ¼ë¡œ, C#12 ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë„ë¡ .csproj íŒŒì¼ì„ ì—…ë°ì´íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤. ë˜í•œ ì‹¤í—˜ì ì¸ ì¸í„°ì…‰í„° ê¸°ëŠ¥ì„ ëª…ì‹œì ìœ¼ë¡œ í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤.

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <!-- ğŸ‘‡ Add this to enable C#12 preview features -->
    <LangVersion>preview</LangVersion>
    <!-- ğŸ‘‡ Enable the interceptors feature -->
    <Features>InterceptorsPreview</Features>
  </PropertyGroup>

</Project>
```

ë‹¤ìŒìœ¼ë¡œ í”„ë¡œì íŠ¸ì—ì„œ `[InterceptsLocation]` íŠ¹ì„±ì„ ì •ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ì´ íŠ¹ì„±ì€ ì¸í„°ì…‰í„° ë™ì‘ì„ êµ¬ë™í•˜ì§€ë§Œ ì•„ì§ ê¸°ë³¸ í´ë˜ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬(BCL)ì— í¬í•¨ë˜ì–´ ìˆì§€ ì•Šìœ¼ë¯€ë¡œ ì§ì ‘ ì •ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ì†ŒìŠ¤ ìƒì„±ê¸°ì—ì„œ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ë„ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤.

í”„ë¡œì íŠ¸ì˜ ì–´ë”˜ê°€ì— ë‹¤ìŒê³¼ ê°™ì´ ì†ì„±ì„ ì •ì˜í•˜ì„¸ìš”.

```csharp
namespace System.Runtime.CompilerServices
{
    [AttributeUsage(AttributeTargets.Method, AllowMultiple = true)]
    sealed class InterceptsLocationAttribute(string filePath, int line, int column) : Attribute
    {
    }
}
```

> ì´ ì •ì˜ë¥¼ ì†ŒìŠ¤ ìƒì„±ê¸°ì™€ ë™ì¼í•œ íŒŒì¼ì— í¬í•¨í•˜ë©´ [íŒŒì¼ ë¡œì»¬ ë²”ìœ„](https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-11#file-local-types)ë¥¼ ì‚¬ìš©í•˜ì—¬ 'ëˆ„ìˆ˜'ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ ì¸í„°ì…‰í„°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë°ëª¨ì—ì„œëŠ” `MapGet()` í˜¸ì¶œì„ ê°€ë¡œì±„ì„œ ê²½ë¡œ íŒ¨í„´ì„ ì½˜ì†”ì— ê¸°ë¡í•œ ë‹¤ìŒ ì›ë˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ë©”ì„œë“œë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤. ì´ê²ƒì€ ê·¸ë‹¤ì§€ ìœ ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ëƒ¥ ë°ëª¨ì¼ ë¿ì…ë‹ˆë‹¤ ğŸ˜….

ì¸í„°ì…‰í„°ë¥¼ ë§Œë“¤ë ¤ë©´ ë‹¤ìŒì´ í•„ìš”í•©ë‹ˆë‹¤.

* ì •ì  í´ë˜ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    
* ëŒ€ìƒ ë©”ì„œë“œì™€ ì •í™•íˆ ë™ì¼í•œ ë§¤ê°œë³€ìˆ˜ì™€ ë°˜í™˜ ìœ í˜•ì„ ê°€ì§„ ë©”ì„œë“œë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
    
* ì¸í„°ì…‰í„°ì— `[InterceptsLocation]` íŠ¹ì„±ì„ ì¶”ê°€í•˜ì—¬ ì¸í„°ì…‰íŠ¸í•˜ë ¤ëŠ” ë©”ì„œë“œì˜ ì†ŒìŠ¤ ìœ„ì¹˜ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
    

ì´ ì˜ˆì œì—ì„œëŠ” `MapGet` í™•ì¥ ë©”ì„œë“œë¥¼ ê°€ë¡œì±„ê³  ì‹¶ìœ¼ë¯€ë¡œ [ì´ì™€ ë™ì¼í•œ ì‹œê·¸ë‹ˆì²˜](https://github.com/dotnet/aspnetcore/blob/a56e968c19be1275db6dc462310d723615b006a7/src/Http/Routing/src/Builder/EndpointRouteBuilderExtensions.cs#L230)ë¥¼ ê°€ì§„ ë©”ì„œë“œë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

```csharp
public static RouteHandlerBuilder MapGet(
        this IEndpointRouteBuilder endpoints,
        [StringSyntax("Route")] string pattern,
        Delegate handler);
```

ì´ëŠ” ì¶©ë¶„íˆ ì‰¬ìš°ë©°, ê¹Œë‹¤ë¡œìš´ ë¶€ë¶„ì€ ì¸í„°ì…‰íŠ¸í•˜ë ¤ëŠ” ë©”ì„œë“œì˜ ì²« ë²ˆì§¸ ë¬¸ìì˜ ìœ„ì¹˜ë¡œ `[InterceptsLocation]`ì„ ì„¤ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤!

> ì´ ë”ì°í•œ í•´í‚¹ ì˜ˆì œì—ì„œëŠ” ê¹Œë‹¤ë¡œìš¸ ë¿ì…ë‹ˆë‹¤. ì†ŒìŠ¤ ìƒì„±ê¸°ì—ì„œëŠ” ì†ŒìŠ¤ ìœ„ì¹˜ì— ì‰½ê²Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.

ì´ ëª¨ë“  ê²ƒì„ ì¢…í•©í•˜ë©´ ì¸í„°ì…‰í„°ì˜ ëª¨ìŠµì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```csharp
static class Interception
{
    // ğŸ‘‡ Define the file, line, and column of the method to intercept
    [InterceptsLocation(@"C:\testapp\Program.cs", line: 4, column: 5)]
    public static RouteHandlerBuilder InterceptMapGet( // ğŸ‘ˆ The interceptor must
        this IEndpointRouteBuilder endpoints,          // have the same signature
        string pattern,                                // as the method being
        Delegate handler)                              // intercepted
    {
        Console.WriteLine($"Intercepted '{pattern}'" );

        return endpoints.MapGet(pattern, handler);
    }
}
```

ê·¸ê²Œ ë‹¤ì…ë‹ˆë‹¤. ì•±ì„ ì‹¤í–‰í•˜ë©´ ì¸í„°ì…‰í„°ê°€ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

```bash
Intercepted '/'
...
```

ì—”ë“œí¬ì¸íŠ¸ê°€ ì—¬ëŸ¬ ê°œì¸ ê²½ìš° ì–´ë–»ê²Œ í•˜ë‚˜ìš”?

```csharp
app.MapGet("/", () => "Hello World!");
app.MapPost("/{name}", (string name) => "Hello {name}!");
```

ë‹¤ë¥¸ HTTP ë™ì‚¬ì´ê¸´ í•˜ì§€ë§Œ ë§¤ê°œë³€ìˆ˜ì™€ ë°˜í™˜ ìœ í˜•ì´ ë™ì¼í•˜ê¸° ë•Œë¬¸ì— ê¸°ì¡´ ì¸í„°ì…‰í„°ë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```csharp
static class Interception
{
    // ğŸ‘‡ Multiple attributes are fine
    [InterceptsLocation(@"C:\testapp\Program.cs", line: 4, column: 5)]
    [InterceptsLocation(@"C:\testapp\Program.cs", line: 5, column: 5)]
    public static RouteHandlerBuilder InterceptMapGet(
        this IEndpointRouteBuilder endpoints,
        string pattern,
        Delegate handler)
    {
        Console.WriteLine($"Intercepted '{pattern}'" );

        return endpoints.MapGet(pattern, handler);
    }
}
```

ë©”ì„œë“œ ì˜¤ë²„ë¡œë“œì— ì£¼ì˜í•˜ì„¸ìš”. ê¸°ì¡´ ì¸í„°ì…‰í„°ë¡œ ë‹¤ìŒ ë©”ì„œë“œ í˜¸ì¶œì„ ê°€ë¡œì±„ë ¤ê³  í•˜ë©´

```csharp
app.MapGet("/ping", (HttpContext context) => Task.CompletedTask);
```

ì»´íŒŒì¼ íƒ€ì„ ì˜ˆì™¸ê°€ ë°œìƒí•©ë‹ˆë‹¤.

```bash
error CS9144: Cannot intercept method 'EndpointRouteBuilderExtensions.MapPost
(IEndpointRouteBuilder, string, RequestDelegate)' with interceptor 'Interception.
InterceptMapGet(IEndpointRouteBuilder, string, Delegate)' because the signatures do not match.
```

ì˜¤ë¥˜ ë©”ì‹œì§€ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, [ì¸í„°ì…‰í„°ì™€ ë§¤ê°œë³€ìˆ˜ ìœ í˜•ì´ ë‹¤ë¥¸ ë©”ì„œë“œ](https://github.com/dotnet/aspnetcore/blob/a56e968c19be1275db6dc462310d723615b006a7/src/Http/Routing/src/Builder/EndpointRouteBuilderExtensions.cs#L65), ì¦‰ `Delegate`ê°€ ì•„ë‹Œ `RequestDelegate`ë¥¼ ì¸í„°ì…‰íŠ¸í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ë‹¤ì‹œ ë§í•˜ì§€ë§Œ, ì†ŒìŠ¤ ì œë„ˆë ˆì´í„°ì˜ ê²½ìš° ì œë„ˆë ˆì´í„°ì—ì„œ ë§¤ê°œë³€ìˆ˜ ìœ í˜•ì„ ì‹ë³„í•˜ê³  ë©”ì„œë“œë¥¼ ë¬´ì‹œí•˜ê±°ë‚˜ ì ì ˆí•œ ì¸í„°ì…‰í„°ë¥¼ ì¶œë ¥í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ í° ë¬¸ì œê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì´ì œ ì¥ë‚œê° ì˜ˆì œë¥¼ ì´í•´í•˜ì…¨ìœ¼ë‹ˆ ì‹¤ì œ ì†ŒìŠ¤ ì œë„ˆë ˆì´í„°ê°€ ì¸í„°ì…‰í„°ë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤!

## ì¸í„°ì…‰í„° ì‚¬ìš©ì„ ìœ„í•œ ë¯¸ë‹ˆë©€ API ìƒì„±ê¸° ì—…ë°ì´íŠ¸

ì´ì „ ê²Œì‹œë¬¼ì—ì„œ .NET 8 ë¯¸ë¦¬ë³´ê¸° 6ì—ì„œ ì œê³µë˜ëŠ” [ë¯¸ë‹ˆë©€ API ì†ŒìŠ¤ ìƒì„±ê¸°](https://dimohy.hashnode.dev/exploring-the-dotnet-8-preview-exploring-the-new-minimal-api-source-generator)ì— ëŒ€í•´ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í•´ë‹¹ ê²Œì‹œë¬¼ì„ ê²Œì‹œí•˜ê¸° ì§ì „ì— ì†ŒìŠ¤ ìƒì„±ê¸° êµ¬í˜„ì„ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ëŒ€ì²´í•˜ëŠ” [PRì´ ë³‘í•©](https://github.com/dotnet/aspnetcore/pull/48817)ë˜ì—ˆìŠµë‹ˆë‹¤!

> ë‹¹ì‹œ ì €ëŠ” ì´ ì‚¬ì‹¤ì— ì¡°ê¸ˆ ë†€ëìŠµë‹ˆë‹¤. ì¸í„°ì…‰í„°ê°€ [.NET 8ì—ì„œ ì‹¤í—˜ ë‹¨ê³„ì— ë¨¸ë¬¼ëŸ¬ ìˆë‹¤ëŠ” ì ](https://devblogs.microsoft.com/dotnet/new-csharp-12-preview-features/#interceptors)ì„ ê°ì•ˆí•  ë•Œ, ì €ëŠ” ì†ŒìŠ¤ ìƒì„±ê¸°(ì‹¤í—˜ ë‹¨ê³„ëŠ” ì•„ë‹ˆì§€ë§Œ ì™„ì „íˆ ì§€ì›ë  ì˜ˆì •)ì—ì„œ í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ ê²ƒì´ë¼ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ [Safia Abdallaê°€ .NET 8ì—ì„œ ë¯¸ë‹ˆë©€ API ìƒì„±ê¸°ê°€ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•(ê·¸ë¦¬ê³  ê·¸ ì´ìœ )](https://twitter.com/captainsafia/status/1682096427881889792)ì— ëŒ€í•œ ìŠ¤ë ˆë“œë¡œ ì‘ë‹µí•´ ì£¼ì—ˆìŠµë‹ˆë‹¤!

ì´ ê¸€ì„ ì“°ëŠ” ì‹œì ì— ìƒˆ ì†ŒìŠ¤ ìƒì„±ê¸°ëŠ” ì•„ì§ ì¶œì‹œë˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ(.NET 8 í”„ë¦¬ë·° 7ì— ì¶œì‹œë  ì˜ˆì •ì„) ì´ ì„¹ì…˜ì˜ ì„¸ë¶€ ì‚¬í•­ì€ ë§¤ìš° ì ì •ì ì¸ ê²ƒì…ë‹ˆë‹¤. ë³€ê²½ ì‚¬í•­ì— ëŒ€í•œ ì„¤ëª…ì€ ìœ ë‹› í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ëœ ìŠ¤ëƒ…ìƒ·ì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ê³  ìˆìŠµë‹ˆë‹¤.

> ìŠ¤ëƒ…ìƒ·ì€ ì´ ì‹œë‚˜ë¦¬ì˜¤ì— ì™„ë²½í•˜ê¸° ë•Œë¬¸ì— ASP.NET Core íŒ€ì—ì„œ ì†ŒìŠ¤ ìƒì„±ê¸° í…ŒìŠ¤íŠ¸ì— ìŠ¤ëƒ…ìƒ· í…ŒìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²ƒì„ ë³´ê³  ë°˜ê°€ì› ìŠµë‹ˆë‹¤. [ì´ì „ ê²Œì‹œë¬¼ì—ì„œ ìì²´ ìƒì„±ê¸°ì—ì„œ ìŠ¤ëƒ…ìƒ· í…ŒìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í–ˆì§€ë§Œ](https://andrewlock.net/creating-a-source-generator-part-2-testing-an-incremental-generator-with-snapshot-testing/), ì €ëŠ” [Simon Cropp](https://twitter.com/SimonCropp)ì˜ í›Œë¥­í•œ [Verify](https://github.com/VerifyTests/Verify) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ MicrosoftëŠ” í›¨ì”¬ ë” ê°„ë‹¨í•œ(ë” ì¡°ì¡í•œ) ëŒ€ì•ˆì„ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.

[ì´ì „ ê¸€](https://dimohy.slogs.dev/exploring-the-dotnet-8-preview-exploring-the-new-minimal-api-source-generator)ì—ì„œ í”„ë¦¬ë·° 6ì—ì„œ ìƒì„±ëœ ì½”ë“œì— ëŒ€í•´ ìì„¸íˆ ì„¤ëª…í–ˆì§€ë§Œ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ê°„ë‹¨íˆ ìš”ì•½í•´ ë³´ê² ìŠµë‹ˆë‹¤.

### ì¸í„°ì…‰í„°ê°€ ì—†ëŠ” í”„ë¦¬ë·° 6ì˜ ë¯¸ë‹ˆë©€ API ìƒì„±ê¸°

ë‹¤ì‹œ ë§í•´, ì¸í„°ì…‰í„° ì—†ì´ [ë¯¸ë‹ˆë©€ API ì†ŒìŠ¤ ìƒì„±ê¸°ëŠ” ìƒì„±ëœ ë©”ì„œë“œê°€ "ì„ íƒ"ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ë©”ì„œë“œ íŠ¹ì´ì„±ì— ì˜ì¡´](https://andrewlock.net/exploring-the-dotnet-8-preview-exploring-the-new-minimal-api-source-generator/#intercepting-method-calls-using-source-generators)í•˜ë©°, `[CallerFilePath]` ë° `[CallerLineNumber]` ì¸ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì†ŒìŠ¤ ì½”ë“œì—ì„œ ìœ„ì¹˜ë¥¼ ìº¡ì²˜í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì´ëŸ¬í•œ í˜¸ì¶œì ì •ë³´ ì¸ìˆ˜ëŠ” ì‚¬ì „ì˜ ì¸ë±ìŠ¤ í‚¤ë¡œ ì‚¬ìš©ë˜ì–´ ìµœì¢…ì ìœ¼ë¡œ ìƒì„±ëœ ì—”ë“œí¬ì¸íŠ¸ í•¸ë“¤ëŸ¬ ì •ì˜ê°€ í¬í•¨ëœ [`RequestDelegateFunc`ë¥¼ ë°˜í™˜](https://andrewlock.net/exploring-the-dotnet-8-preview-exploring-the-new-minimal-api-source-generator/#looking-at-the-generated-requestdelegatefunc)í•©ë‹ˆë‹¤.

ì„ì‹œ 'ê°€ë¡œì±„ê¸°' ì¸í”„ë¼ì—ëŠ” ê½¤ ë§ì€ ë©”ì„œë“œì™€ ìœ í˜•ì´ ìˆìŠµë‹ˆë‹¤:

1. "íŠ¹ì •ì„±ì„ í†µí•œ ê°€ë¡œì±„ê¸°" ë©”ì„œë“œëŠ” ì•±ì˜ ê° `MapGet()`/`MapPost()` ë“±ì˜ í˜¸ì¶œì— ëŒ€í•´ ì •ì˜ë©ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” í•¸ë“¤ëŸ¬ì˜ ì‹œê·¸ë‹ˆì²˜ì™€ ì¼ì¹˜í•˜ëŠ” (ëœ íŠ¹ì •ì ì¸ `Delegate` ëŒ€ì‹ ) `Func<>`ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤. ì„œëª…ì´ ë‹¤ë¥¼ ë•Œë§ˆë‹¤ ì´ ë©”ì„œë“œì˜ ë²„ì „ì´ ë‹¤ë¥´ë¯€ë¡œ `Func<string>`ê³¼ `Func<string, string>`ì—ëŠ” ì„œë¡œ ë‹¤ë¥¸ ë©”ì„œë“œê°€ í•„ìš”í•©ë‹ˆë‹¤.
    

```csharp
internal static RouteHandlerBuilder MapGet(
    this IEndpointRouteBuilder endpoints,
    string pattern,
    Func<string> handler,  // ğŸ‘ˆ matches the endpoint handler definition signature
    [CallerFilePath] string filePath = "",
    [CallerLineNumber]int lineNumber = 0);
```

1. ì´ ë©”ì„œë“œëŠ” `MapCore()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ëª¨ë“  ì„¸ë¶€ ì •ë³´ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. `MapCore()`ëŠ” ì œê³µëœ `filePath`ì™€ `lineNumber`ë¥¼ ë”•ì…”ë„ˆë¦¬ì˜ í‚¤ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
    

```csharp
file static class GeneratedRouteBuilderExtensionsCore
{
    internal static RouteHandlerBuilder MapCore(
        this IEndpointRouteBuilder routes,
        string pattern,
        Delegate handler,
        IEnumerable<string>? httpMethods,
        string filePath,
        int lineNumber)
    {
        // ğŸ‘‡Use the filePath and lineNumber as an index into the map dictionary
        var (populateMetadata, createRequestDelegate) = map[(filePath, lineNumber)];

        // Pass the functions to the minimal API internals
        return RouteHandlerServices.Map(routes, pattern, handler, httpMethods, populateMetadata, createRequestDelegate);
    }
}
```

1. ë”•ì…”ë„ˆë¦¬ì—ëŠ” ì•±ì˜ ëª¨ë“  `MapGet()` í˜¸ì¶œì— ëŒ€í•œ í•­ëª©ì´ ìˆìŠµë‹ˆë‹¤. í•­ëª©ì˜ ê°’ì€ í•„ìˆ˜ `MetadataPopulator`ì™€ `RequestDelegateFunc` êµ¬í˜„ì„ í¬í•¨í•˜ëŠ” íŠœí”Œì…ë‹ˆë‹¤.
    

```csharp
file static class GeneratedRouteBuilderExtensionsCore
{
    private static readonly Dictionary<(string, int), (MetadataPopulator, RequestDelegateFactoryFunc)> map = new()
    {
        [(@"C:\testapp\Program.cs", 4)] = // "/", () => "Hello World!"
        (
            (methodInfo, options) => { /*   */ }, // MetadataPopulator
            (del, options, inferredMetadataResult) => { /*   */ }, // RequestDelegateFactoryFunc
        ),
        [(@"C:\testapp\Program.cs", 5)] = // "/{name}", (string name) => "Hello {name}!"
        (
            (methodInfo, options) => { /*   */ }, // MetadataPopulator
            (del, options, inferredMetadataResult) => { /*   */ }, // RequestDelegateFactoryFunc
        ),
    }
}
```

ì´ì œ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ìƒí™©ì´ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ ì‚´í´ë´…ì‹œë‹¤!

### ì¸í„°ì…‰í„° ê¸°ë°˜ ë¯¸ë‹ˆë©€ API ìƒì„±ê¸°

ì•„ë˜ í‘œì‹œëœ ì½”ë“œëŠ” [ì—¬ê¸°](https://github.com/dotnet/aspnetcore/blob/1121b2bbb123ad9044d593955e7a2ef863fcf2e5/src/Http/Http.Extensions/test/RequestDelegateGenerator/RequestDelegateCreationTests.Responses.cs#L26) ìœ ë‹› í…ŒìŠ¤íŠ¸ì˜ [ìŠ¤ëƒ…ìƒ· ê²°ê³¼](https://github.com/dotnet/aspnetcore/blob/1121b2bbb123ad9044d593955e7a2ef863fcf2e5/src/Http/Http.Extensions/test/RequestDelegateGenerator/Baselines/Multiple_MapAction_NoParam_StringReturn.generated.txt)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.

> ì´ ì½”ë“œëŠ” ì•„ì§ í”„ë¦¬ë·° ë²„ì „ì´ ì•„ë‹ˆë¯€ë¡œ 11ì›” ì •ì‹ ì¶œì‹œ ì „ì— ë³€ê²½ë  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ê¸°ì–µí•˜ì„¸ìš”!

ì´ì „ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ êµ¬í˜„ ê°„ì— ë³€ê²½ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ `MetadataPopulator` ë° `RequestDelegateFactoryFunc` ì •ì˜ëŠ” ìˆ¨ê¸°ê² ìŠµë‹ˆë‹¤. ê°€ì¥ í° ë³€í™”ëŠ” ì¸í„°ì…‰í„° ê¸°ë°˜ ì†ŒìŠ¤ ìƒì„±ê¸°ì— 3ë‹¨ê³„ ëŒ€ì‹  1ë‹¨ê³„ë§Œ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

```csharp
file static class GeneratedRouteBuilderExtensionsCore
{
    private static readonly string[] GetVerb = new[] { global::Microsoft.AspNetCore.Http.HttpMethods.Get };

    [InterceptsLocation(@"C:\testapp\Program.cs", 4, 5)]
    internal static RouteHandlerBuilder MapGet0(
        this IEndpointRouteBuilder endpoints,
        string pattern,
        Delegate handler)
    {
        MetadataPopulator populateMetadata = (methodInfo, options) => { /*   */ },
        RequestDelegateFactoryFunc createRequestDelegate = (del, options, inferredMetadataResult) => { /*   */ },

        return MapCore(endpoints, pattern, handler, GetVerb, populateMetadata, createRequestDelegate);
    }
    // ...
}
```

ê·¸ê²Œ ë‹¤ì…ë‹ˆë‹¤! (ì ì¬ì ìœ¼ë¡œ) ì·¨ì•½í•œ "íŠ¹ì´ì„±" íŠ¸ë¦­ì´ë‚˜ `[CallerFilePath]` ë° ì‚¬ì „ ì¡°íšŒê°€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¸í„°ì…‰í„° ì†ì„±ì„ ì‚¬ìš©í•˜ë©´ ê° `MapGet()`/`MapPost()` í˜¸ì¶œì„ ìƒì„±ëœ ë©”ì„œë“œì— ê¹”ë”í•˜ê²Œ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°ê¸° ë‹¤ë¥¸ ì—”ë“œí¬ì¸íŠ¸ í•¸ë“¤ëŸ¬ ì‹œê·¸ë‹ˆì²˜ì—ëŠ” ê°ê¸° ë‹¤ë¥¸ `RequestDelegateFunc`ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì—¬ëŸ¬ ì—”ë“œí¬ì¸íŠ¸ì— ë™ì¼í•œ ì„œëª…ì´ ìˆëŠ” ê²½ìš°, ì •ì˜ì— `[InterceptsLocation]` ì†ì„±ì„ ì¶”ê°€í•˜ì—¬ ìƒì„±ëœ ì •ì˜ë¥¼ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¸í„°ì…‰í„° ì ‘ê·¼ ë°©ì‹ì—ëŠ” ëª‡ ê°€ì§€ ì´ì ì´ ìˆìŠµë‹ˆë‹¤.

* ë” ë¹¨ë¼ì§(ë‹¨ì¼ ë©”ì„œë“œ í˜¸ì¶œ ë° ì‚¬ì „ ì¡°íšŒ ì—†ìŒ)
    
* ì´í•´í•˜ê¸° ì‰¬ì›€(ì´ ì½”ë“œëŠ” í”„ë¡œì íŠ¸ì—ì„œ ìƒì„±ë˜ë©°, ìƒì„±ê¸° ì†Œë¹„ìë¡œì„œ ë” ì‰½ê²Œ ë”°ë¼í•  ìˆ˜ ìˆìŒ)
    
* ìœ ì§€ ê´€ë¦¬ê°€ ë” ì‰¬ì›€(ì´í•´í•˜ê¸° ì‰¬ìš°ë¯€ë¡œ)
    
* ë©”ì„œë“œ ì„ íƒ ê´€ë ¨ ë¬¸ì œ ì œê±°(ì†ŒìŠ¤ì—ì„œ ìƒì„±ëœ ë²„ì „ì´ ì„ íƒëœë‹¤ëŠ” ë³´ì¥ì´ ì—†ìœ¼ë¯€ë¡œ ê¸°ìˆ ì ìœ¼ë¡œ ë” êµ¬ì²´ì ì¸ ë©”ì„œë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)
    

ì´ êµ¬í˜„ì˜ ìœ ì¼í•œ ë‹¨ì ì€ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ì ì¸ë°, ì´ëŠ” ì‹¤í—˜ì ì¸ ê¸°ëŠ¥ì´ë©° 11ì›”ì— ì¶œì‹œë˜ëŠ” .NET 8 ë¦´ë¦¬ìŠ¤ì—ì„œë„ ê·¸ëŒ€ë¡œ ìœ ì§€ë  ì˜ˆì •ì…ë‹ˆë‹¤. ì¦‰, ë¯¸ë‹ˆë©€ API AOT ì†ŒìŠ¤ ìƒì„±ê¸°ê°€ (í˜„ì¬) í”„ë¡œì íŠ¸ì—ì„œ ì¸í„°ì…‰í„° ê¸°ëŠ¥ì„ ìë™ìœ¼ë¡œ í™œì„±í™”í•©ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ëŠ” ì•Šê² ì§€ë§Œ, ëˆ„êµ°ê°€ëŠ” ì´ì— ëŒ€í•´ ì§œì¦ì„ ë‚¼ ê²ƒ ê°™ìŠµë‹ˆë‹¤ ğŸ˜….

## ì¸í„°ì…‰í„°ì— ëŒ€í•œ ì œí•œ ì‚¬í•­

ì´ ê¸€ì—ì„œëŠ” ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ì¼ë°˜ì ì¸ ë°©ë²•ê³¼ ì´ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‹¤ì œ ì†ŒìŠ¤ ìƒì„±ê¸° êµ¬í˜„ì˜ ì˜ˆ, ê·¸ë¦¬ê³  ì†ŒìŠ¤ ìƒì„±ê¸° ì‘ì„±ìì˜ ì‘ì—…ì„ ë” ì‰½ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ë°©ë²•ì— ëŒ€í•´ ì‚´í´ë´¤ìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ í˜„ì¬ ì¸í„°ì…‰í„° ì„¤ê³„ì— ëŒ€í•œ ë¹„íŒì€ [dotnet/csharplang#7009](https://github.com/dotnet/csharplang/issues/7009) ì´ìŠˆì—ì„œ ê½¤ ë§ì´ ì œê¸°ë˜ì—ˆìŠµë‹ˆë‹¤. 100ê°œ ì´ìƒì˜ ëŒ“ê¸€ì´ ë‹¬ë ¸ìœ¼ë‹ˆ í† ë¼êµ´ì— ë“¤ì–´ê°€ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´ ì¦ê²¨ë³´ì„¸ìš”! ì—¬ëŸ¬ë¶„ì˜ ê¸°ëŒ€ì¹˜ë¥¼ ë‚®ì¶”ê¸° ìœ„í•´ ì•„ë˜ì— ëª‡ ê°€ì§€ ëª…ë°±í•œ ë””ìì¸ í•œê³„ë¥¼ ì§šì–´ë³´ì•˜ìŠµë‹ˆë‹¤!

### 1\. ë©”ì„œë“œë§Œ í•´ë‹¹

í˜„ì¬ ì¸í„°ì…‰í„° ì„¤ê³„ëŠ” ë©”ì„œë“œ ì¸í„°ì…‰íŠ¸ì—ë§Œ ì´ˆì ì„ ë§ì¶”ê³  ìˆìŠµë‹ˆë‹¤. ì¦‰, ì†ì„± ì ‘ê·¼ìë‚˜ ë” ì¤‘ìš”í•œ ìƒì„±ìëŠ” ê°€ë¡œì±Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒì„±ì ì§€ì ì€ í¥ë¯¸ë¡œìš´ë°, ì‚¬ìš©ìê°€ ì½”ë“œë¥¼ ë³€ê²½í•  í•„ìš” ì—†ì´ ì†ŒìŠ¤ì—ì„œ ìƒì„±ëœ `Regex` êµ¬í˜„ìœ¼ë¡œ `new Regex("a-z+")`ê³¼ ê°™ì€ ê²ƒì„ ìë™ìœ¼ë¡œ ê°€ë¡œì±Œ ìˆ˜ ìˆë‹¤ëŠ” ì˜ë¯¸ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. í˜„ì¬ `Regex` ë˜ëŠ” `ILogger` ì†ŒìŠ¤ ìƒì„±ê¸°ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ê±°ì³ì•¼ í•˜ë¯€ë¡œ ë§¤ìš° í¥ë¯¸ë¡œìš´ ì¼ì´ ë  ê²ƒì…ë‹ˆë‹¤.

### 2\. ë©”ì„œë“œ ì„œëª…ì€ ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

ì´ê²ƒì€ ë°˜ë“œì‹œ ë¬¸ì œê°€ ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë©°, ë‹¨ì§€ ì£¼ì˜í•´ì•¼ í•  ì‚¬í•­ì…ë‹ˆë‹¤. ì¸í„°ì…‰íŠ¸í•˜ëŠ” ë©”ì„œë“œì˜ ë©”ì„œë“œ ì¸ìˆ˜ë¥¼ ì¸í„°ì…‰í„° ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ê°„ë‹¨íˆ ìºìŠ¤íŒ…í•  ìˆ˜ ìˆë‹¤ê³  í•´ë„ ì´ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì»´íŒŒì¼ëŸ¬ëŠ” ì•ì„œ ì„¤ëª…í•œ ê²ƒì²˜ëŸ¼ ë¬´ì—‡ì„ ì˜ëª»í–ˆëŠ”ì§€ ì„¤ëª…í•˜ëŠ” ìœ ìš©í•œ ì˜¤ë¥˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```bash
error CS9144: Cannot intercept method 'EndpointRouteBuilderExtensions.MapPost
(IEndpointRouteBuilder, string, RequestDelegate)' with interceptor 'Interception.InterceptMapGet(IEndpointRouteBuilder, string, Delegate)' because the signatures do not match.
```

ë”°ë¼ì„œ ì´ ì˜¤ë¥˜ë¥¼ ì£¼ì˜ ê¹Šê²Œ ì½ì–´ë³´ì„¸ìš”! ì‚¬ìš© ì‚¬ë¡€ì— ë”°ë¼ [ë” ë§ì€ ë©”ì„œë“œë¥¼ ìƒì„±í•´ì•¼ í•  ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ](https://github.com/dotnet/csharplang/issues/7009#issuecomment-1580277384) ì£¼ì˜í•´ì•¼ í•  ì‚¬í•­ì…ë‹ˆë‹¤.

### 3\. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì½”ë“œì—ì„œ ë©”ì„œë“œë¥¼ ê°€ë¡œì±Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ì¸í„°ì…‰í„°ëŠ” ì†ŒìŠ¤ ìƒì„±ê¸°ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì»´íŒŒì¼ í”„ë¡œì„¸ìŠ¤ì˜ ì¼ë¶€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì¦‰, ì§ì ‘ ì»´íŒŒì¼í•˜ëŠ” ì½”ë“œì—ì„œ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œ í˜¸ì¶œë§Œ ì¸í„°ì…‰íŠ¸í•  ìˆ˜ ìˆìœ¼ë©°, NuGetì—ì„œ ì°¸ì¡°í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œ í˜¸ì¶œì€ ì¸í„°ì…‰íŠ¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

êµ¬ì²´ì ì¸ ì˜ˆë¥¼ ë“¤ì–´ íšŒì‚¬ì—ì„œ ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì¶”ê°€í•˜ëŠ” í‘œì¤€ ë¯¸ë‹ˆë©€ API ì—”ë“œí¬ì¸íŠ¸ ì„¸íŠ¸ê°€ ìˆë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì‘ì—…ì„ ë‹¨ìˆœí™”í•˜ê¸° ìœ„í•´ ì´ëŸ¬í•œ í˜¸ì¶œì„ ìº¡ìŠí™”í•˜ëŠ” ë‚´ë¶€ NuGet íŒ¨í‚¤ì§€ë¥¼ ë§Œë“­ë‹ˆë‹¤. íŒ¨í‚¤ì§€ ì‚¬ìš©ìëŠ” í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.

```csharp
app.AddStandardEndpoints();
```

ê·¸ë¦¬ê³  ë’¤ì—ì„œì˜ `AddStandardEndpoints()` í™•ì¥ ë©”ì„œë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë³´ì…ë‹ˆë‹¤.

```csharp
public static class StandardEndpointExtensions
{
    public static IEndpointRouteBuilder AddStandardEndpoints(this IEndpointRouteBuilder app)
    {
        app.MapGet("/healthz", () => "OK");
        app.MapGet("/metrics", () => {});
        // ... etc
    }
}
```

`AddStandardEndpoints()` ë©”ì„œë“œëŠ” NuGet íŒ¨í‚¤ì§€ì— ì •ì˜ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì´ë¯¸ ì»´íŒŒì¼ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì¦‰, ë¯¸ë‹ˆë©€ API ì†ŒìŠ¤ ìƒì„±ê¸°ê°€ í•´ë‹¹ `MapGet` í˜¸ì¶œì„ ê°€ë¡œì±„ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ í˜¸ì¶œì— ëŒ€í•´ AOTë¥¼ ì§€ì›í•˜ëŠ” ìœ ì¼í•œ ë°©ë²•ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì»´íŒŒì¼í•  ë•Œ ë¯¸ë‹ˆë©€ API ì†ŒìŠ¤ ìƒì„±ê¸°ë¥¼ í™œì„±í™”í•œ í›„ NuGetì— ë°°í¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ì´ ë°©ë²•ì€ ì—¬ëŸ¬ ë©´ì—ì„œ ë” ê°„ë‹¨í•˜ì§€ë§Œ "ì¼ë°˜ì ì¸" ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë°(AOP)ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ìœ¼ë¡œì„œ ì¸í„°ì…‰í„°ì˜ ìœ ìš©ì„±ì„ ì œí•œí•©ë‹ˆë‹¤.

### 4\. ì¸í„°ì…‰í„°ëŠ” ì™„ì „í•œ AOP ì†”ë£¨ì…˜ì´ ì•„ë‹™ë‹ˆë‹¤.

ì´ëŠ” 3ë²ˆì—ì„œ ì–´ëŠ ì •ë„ ì´ì–´ì§€ì§€ë§Œ, ë©”ì„œë“œ ê°€ë¡œì²´ê¸°ëŠ”ëŠ” [PostSharp/Metalama](https://www.postsharp.net/metalama)ì™€ ê°™ì€ AOP ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì¼ë°˜ì ì¸ ê¸°ëŠ¥ì´ë¼ëŠ” ì ì„ ë§ì”€ë“œë¦¬ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë” ë§ì€ AOP ê¸°ëŠ¥ê³¼ ì†”ë£¨ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤.

ì¸í„°ì…‰í„° ì„¤ê³„ì— ëŒ€í•œ í° ë¹„íŒ ì¤‘ í•˜ë‚˜ëŠ” ì§„ì •í•œ AOP ì†”ë£¨ì…˜ìœ¼ë¡œ 'ì„±ì¥'í•˜ëŠ” ê²ƒì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ê°œì¸ì ìœ¼ë¡œ ì´ëŠ” íƒ€ë‹¹í•œ ìš°ë ¤ë¼ê³  ìƒê°í•©ë‹ˆë‹¤. í˜„ì¬ ë””ìì¸ì€ ë§¤ìš° "ë…ë¦½í˜•"ìœ¼ë¡œ ëŠê»´ì§€ëŠ”ë°, ì´ëŠ” ê´œì°®ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤(íŠ¹íˆ ì œê°€ ì ˆì‹¤íˆ ì›í•˜ëŠ” ë‹¤ë¥¸ AOP ì ‘ê·¼ ë°©ì‹ì´ ë§ì§€ ì•Šê¸° ë•Œë¬¸ì—). ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³  "ë‹¨ì¼ ë…ë¦½í˜• ê¸°ëŠ¥"ì´ ì•„ë‹Œ ["AOP í”„ë ˆì„ì›Œí¬" ì ‘ê·¼ ë°©ì‹ì„ ì±„íƒ](https://github.com/dotnet/csharplang/issues/7009#issuecomment-1479711571)í•˜ëŠ” ê²ƒì´ ì»´íŒŒì¼ëŸ¬ì— ë” ê°•ë ¥í•œ ì¥ê¸°ì ì¸ ì†”ë£¨ì…˜ì´ ë  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“­ë‹ˆë‹¤. ì¸í„°ì…‰í„°ê°€ ì•„ì§ ì‹¤í—˜ ë‹¨ê³„ì— ë¶ˆê³¼í•˜ë‹¤ëŠ” ì ì„ ê°ì•ˆí•˜ë©´ ì•„ì§ ë³€í™”í•  ì‹œê°„ì´ ìˆìŠµë‹ˆë‹¤!

### 5\. íŒŒì¼ ê²½ë¡œë¡œ ì¸í•´ ìƒì„±ê¸° ì¶œë ¥ ì§€ì†ì— ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.

ì‚¬ì†Œí•œ ê¸°ëŠ¥ì´ì§€ë§Œ ì €ëŠ” [ì†ŒìŠ¤ ìƒì„±ê¸° ì¶œë ¥ì„ ë””ìŠ¤í¬ì— ì¶œë ¥](https://andrewlock.net/creating-a-source-generator-part-6-saving-source-generator-output-in-source-control/)í•˜ì—¬ ì†ŒìŠ¤ ì œì–´ì— í¬í•¨í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ë¶€ìˆ˜ì ì¸ ë³€ê²½ ì‚¬í•­ì˜ ì˜í–¥ì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìƒì„±ëœ ì½”ë“œì˜ ë³€ê²½ ì‚¬í•­ì„ í¬í•¨í•˜ì—¬ ëª¨ë“  íš¨ê³¼ì ì¸ ì½”ë“œ ë³€ê²½ ì‚¬í•­ì„ ê²€í† í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ PRì˜ ì½”ë“œ ê²€í† ì— íŠ¹íˆ ìœ ìš©í•©ë‹ˆë‹¤.

> Datadogì—ì„œëŠ” ëª¨ë“  PRì—ì„œ ì‹¤í–‰ë˜ëŠ” [GitHub ì‘ì—…ë„ ìˆì–´](https://github.com/DataDog/dd-trace-dotnet/blob/master/.github/workflows/verify_source_generated_changes_are_persisted.yml) ì†ŒìŠ¤ ìƒì„±ê¸° ë³€ê²½ ì‚¬í•­ì„ ì˜¬ë°”ë¥´ê²Œ ì»¤ë°‹í•˜ê³  í‘¸ì‹œí–ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

ì•ˆíƒ€ê¹ê²Œë„ ì¸í„°ì…‰í„°ëŠ” ì†ŒìŠ¤ ì½”ë“œì— ì¸í„°ì…‰íŠ¸ ëŒ€ìƒì˜ íŒŒì¼ ê²½ë¡œë¥¼ ë¦¬í„°ëŸ´ ë¬¸ìì—´ë¡œ ì‘ì„±í•´ì•¼ í•˜ë¯€ë¡œ ì´ëŸ¬í•œ ì ‘ê·¼ ë°©ì‹ì´ ê¹¨ì§ˆ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.

```csharp
[InterceptsLocation(@"C:\testapp\Program.cs", 4, 5)]
```

ë¬¸ì œëŠ” ì½”ë“œê°€ ì–´ë–¤ ë””ë ‰í† ë¦¬ì—ì„œ ì²´í¬ ì•„ì›ƒë˜ëŠ”ì§€, ë¦¬ëˆ…ìŠ¤, ë§¥OS ë˜ëŠ” ìœˆë„ìš°ì—ì„œ ì‹¤í–‰ë˜ëŠ”ì§€ì— ë”°ë¼ íŒŒì¼ ê²½ë¡œê°€ ë‹¬ë¼ì§„ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤ ğŸ™ ì†”ì§íˆ ì´ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•´ì•¼ í• ì§€ ì˜ ëª¨ë¥´ê² ê³ , (í”„ë¡œì íŠ¸ì— ë‘ ëª… ì´ìƒì´ ì‘ì—…í•˜ëŠ” ê²½ìš°) ìƒì„±ê¸° ì½”ë“œë¥¼ ì§€ì†í•˜ëŠ” ê²ƒê³¼ ê·¼ë³¸ì ìœ¼ë¡œ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ê²ƒ ê°™ì•„ì„œ ì¡°ê¸ˆ ìŠ¬íìŠµë‹ˆë‹¤.

### 6\. ë©”ì„œë“œ êµì²´ì— ë”°ë¥¸ ë³´ì•ˆ ë¬¸ì œ

[dotnet/csharplang#7009](https://github.com/dotnet/csharplang/issues/7009) ì´ìŠˆì—ì„œ ë§ì€ ì‚¬ëŒë“¤ì´ ì´ ë¬¸ì œë¥¼ ì œê¸°í–ˆê¸° ë•Œë¬¸ì— ì´ ë¬¸ì œë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. [ì˜ˆë¥¼ ë“¤ì–´](https://github.com/dotnet/csharplang/issues/7009#issuecomment-1613192957)

> ì–´ë–¤ ë³´ì•ˆ ë¬¸ì œê°€ ìˆë‚˜ìš”?
> 
> * ë©”ì„œë“œ í•˜ì´ì¬í‚¹
>     
> * ì˜ˆë¥¼ ë“¤ì–´ ì ì¬ì ìœ¼ë¡œ ì•…ì˜ì ì¸ ì½”ë“œ ì‚½ì…
>     
> * ì¤‘ìš”í•œ ë¶€ì‘ìš©ì„ ë¬´ì‹œí•˜ëŠ” ê²½ìš°
>     
> * í˜¸ì¶œì´ ì™„ì „íˆ ëŒ€ì²´ë˜ì–´ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì‚¬ìš©ì ì•Œë¦¼ ëˆ„ë½
>     

ê·¸ëŸ¬ë‚˜ **ì¸í„°ì…‰í„°ëŠ” ê¸°ì¡´ ì†ŒìŠ¤ ìƒì„±ê¸°ë‚˜ NuGet íŒ¨í‚¤ì§€ë³´ë‹¤ ë” ë§ì€ ë³´ì•ˆ ë¬¸ì œë¥¼ ì•¼ê¸°í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

ì €ëŠ” ì´ ì ì„ ê°•ì¡°í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤. ì´ë¯¸ ë¯¸ë¦¬ë³´ê¸° 6 ë¯¸ë‹ˆë©€ APIì™€ êµ¬ì„± ë°”ì¸ë” ì†ŒìŠ¤ë¥¼ í†µí•´ ì¸í„°ì…‰í„° ì—†ì´ ë©”ì„œë“œ í˜¸ì¶œì„ 'í•˜ì´ì¬í‚¹'í•˜ëŠ” ê²ƒì´ ì™„ë²½í•˜ê²Œ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì„ ë³´ì—¬ë“œë ¸ìŠµë‹ˆë‹¤! í•˜ì§€ë§Œ ì´ë¥¼ ìœ„í•´ ì†ŒìŠ¤ ìƒì„±ê¸°ë¥¼ ì‚¬ìš©í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ê¸°ì¡´ í™•ì¥ ë©”ì„œë“œë¥¼ "ì¬ì •ì˜"í•˜ëŠ” ì•…ì„± NuGet íŒ¨í‚¤ì§€ë¡œ ìœ„ì˜ ëª¨ë“  ìš°ë ¤ ì‚¬í•­ì„ ë‹¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ì¸í„°ì…‰í„°ì— ëŒ€í•œ ëª¨ë“  ìš°ë ¤ ì‚¬í•­ ì¤‘ì—ì„œ ë³´ì•ˆì€ ê·¸ ì¤‘ í•˜ë‚˜ê°€ ë˜ì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤. í”„ë¡œì íŠ¸ì— ì¶”ê°€í•˜ëŠ” ëª¨ë“  NuGet íŒ¨í‚¤ì§€ë¥¼ ì •ë§ë¡œ ì‹ ë¢°í•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ê°•ì¡°í•˜ëŠ” ê²ƒì¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ì´ë¯¸ ê¸€ì´ ë„ˆë¬´ ê¸¸ì–´ì¡Œê¸° ë•Œë¬¸ì— [ë§ˆí¬ ê·¸ë¼ë²¨](https://blog.marcgravell.com/)ì´ ì‘ì„±í•œ [Dapper ì¸í„°ì…‰í„° ë¹Œë“œ ë„êµ¬ì— ëŒ€í•œ ê°„ë‹¨í•œ ê°œë… ì¦ëª…](https://github.com/dotnet/csharplang/issues/7009#issuecomment-1578800679) ê²°ê³¼ë§Œ ë‚¨ê²¨ë‘ê² ìŠµë‹ˆë‹¤.

> * ë¹Œë“œ ë„êµ¬ë¥¼ ì¶”ê°€í•˜ë©´ ì‹œì‘ ì‹œê°„ì´ ìµœëŒ€ 95msì—ì„œ ìµœëŒ€ 37msë¡œ ê°œì„ ë˜ë©°, í›„ì† ì½ê¸° ì†ë„ì—ëŠ” í° ë³€í™”ê°€ ì—†ìŠµë‹ˆë‹¤(ì•½ 270~280ms ìœ ì§€)
>     
> * ì „ì²´ AOT ëª¨ë“œëŠ” ì‹œì‘ ì‹œê°„ì„ 0ìœ¼ë¡œ ì¤„ì´ê³  í›„ì† ì„±ëŠ¥ì„ ìµœëŒ€ 225msê¹Œì§€ ê°œì„ í•©ë‹ˆë‹¤.
>     
> * ë¬¼ë¡  DapperAOTë¥¼ ì‚¬ìš©í•œ ì „ì²´ AOT ëª¨ë“œëŠ” ì´ì œ ì‘ë™í•œë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤(ì´ì „ì—ëŠ” ëŸ°íƒ€ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤)
>     

ì „ë°˜ì ìœ¼ë¡œ ë§¤ìš° ìœ ë§í•©ë‹ˆë‹¤!

## ìš”ì•½

ì´ ê¸€ì—ì„œëŠ” ì‹¤í—˜ì ì¸ C#12 ê¸°ëŠ¥ì¸ ì¸í„°ì…‰í„°ì— ëŒ€í•´ ì‚´í´ë´¤ìŠµë‹ˆë‹¤. ë©”ì„œë“œ í˜¸ì¶œì„ ë‹¤ë¥¸ ë©”ì„œë“œ(ì¼ë°˜ì ìœ¼ë¡œ ì†ŒìŠ¤ ìƒì„±)ë¡œ ëŒ€ì²´í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í–ˆëŠ”ë°, ì˜ˆë¥¼ ë“¤ì–´ ê¸°ì¡´ êµ¬í˜„ì„ AOT ì¹œí™”ì ì¸ êµ¬í˜„ìœ¼ë¡œ ëŒ€ì²´í•˜ëŠ” ë° ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒìœ¼ë¡œ ì¸í„°ì…‰í„°ê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ì— ëŒ€í•œ ì•„ì£¼ ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ `[InterceptsLocation]` ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ë³´ì—¬ë“œë ¸ìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ [ì´ì „ ê²Œì‹œë¬¼](https://dimohy.slogs.dev/exploring-the-dotnet-8-preview-exploring-the-new-minimal-api-source-generator)ì—ì„œ ì„¤ëª…í•œ ì ‘ê·¼ ë°©ì‹ ëŒ€ì‹  ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ASP.NET Core ë¯¸ë‹ˆë©€ API ì†ŒìŠ¤ ìƒì„±ê¸°ê°€ ì–´ë–»ê²Œ ì—…ë°ì´íŠ¸ë˜ì—ˆëŠ”ì§€ ë³´ì—¬ë“œë ¸ìŠµë‹ˆë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ ì¸í„°ì…‰í„°ì— ëŒ€í•œ ëª‡ ê°€ì§€ ì œí•œ ì‚¬í•­ê³¼ ë¬¸ì œì ì— ëŒ€í•´ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œ ëŒ€ë¶€ë¶„ì€ ì„¤ê³„ ì„ íƒê³¼ ê´€ë ¨ëœ ê²ƒì´ì§€ë§Œ, ì œ ì‚¬ìš© ì‚¬ë¡€ì—ì„œ ê°€ì¥ ë¬¸ì œê°€ ë˜ëŠ” ê²ƒì€ íŒŒì¼ ì°¨ì´ ë¬¸ì œë¡œ ì¸í•´ ì†ŒìŠ¤ ìƒì„±ê¸° ì¶œë ¥ì„ ì†ŒìŠ¤ ì œì–´ì—ì„œ ìœ ì§€í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ìì£¼ ì–¸ê¸‰ë˜ëŠ” ìš°ë ¤ ì‚¬í•­ ì¤‘ í•˜ë‚˜ì¸ ë³´ì•ˆì€ ì¸í„°ì…‰í„°ê°€ íƒ€ì‚¬ NuGet íŒ¨í‚¤ì§€ë³´ë‹¤ ë” ë§ì€ ìœ„í—˜ì„ ì´ˆë˜í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¬¸ì œê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.